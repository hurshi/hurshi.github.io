---
layout: post
title: Go SS
catalog: false
tags:
    - 操作系统
    - shell
    - tools
---

这里是快速🔜通道，详情见[Ubuntu 文章]({% post_url 2019-03-05-ubuntu %})


1. 升级系统到 18.04
   ```
   sudo apt update && sudo apt dist-upgrade && sudo apt autoremove
   sudo apt-get install update-manager-core
   
   # 确保最下方有:Prompt=lts
   sudo vi /etc/update-manager/release-upgrades 
   
   # 这里需要将近1个小时
   sudo do-release-upgrade -d 
   ```

2. 安装ss

   ```
   cd ~
   mkdir -p workspace
   cd workspace
   
   git clone https://github.com/shadowsocks/shadowsocks-libev.git
   cd shadowsocks-libev
   git submodule update --init --recursive
   
   # Installation of basic build dependencies
   sudo apt-get install --no-install-recommends gettext build-essential autoconf libtool libpcre3-dev asciidoc xmlto libev-dev libc-ares-dev automake libmbedtls-dev libsodium-dev
   
   # Installation of libsodium
   export LIBSODIUM_VER=1.0.16
   wget https://download.libsodium.org/libsodium/releases/libsodium-$LIBSODIUM_VER.tar.gz
   tar xvf libsodium-$LIBSODIUM_VER.tar.gz
   pushd libsodium-$LIBSODIUM_VER
   ./configure --prefix=/usr && make
   sudo make install
   popd
   sudo ldconfig
   
   # Installation of MbedTLS
   export MBEDTLS_VER=2.6.0
   wget https://tls.mbed.org/download/mbedtls-$MBEDTLS_VER-gpl.tgz
   tar xvf mbedtls-$MBEDTLS_VER-gpl.tgz
   pushd mbedtls-$MBEDTLS_VER
   make SHARED=1 CFLAGS="-O2 -fPIC"
   sudo make DESTDIR=/usr install
   popd
   sudo ldconfig
   
   # Start building
   ./autogen.sh && ./configure && make
   sudo make install
   ```

3. 配置 ss Json  规则

   ```
   cd /etc/
   mkdir -p shadowsocks-libev
   cd shadowsocks-libev
   echo '''{
      "server":"___MY_SERVICE_IP___",
      "server_port":8399,
      "password":"___MY_PASSWORD___",
      "timeout":300,
      "method":"aes-256-cfb",
      "fast_open":false
   }''' > /etc/shadowsocks-libev/config.json
   ```

4.  配置到ss服务到 systemctl 中

   ```
   sudo echo '''[Unit]
   Description=Shadowsocks-Libev Custom Client Service
   Documentation=man:ss-server(1)
   After=network.target
   
   [Service]
   AmbientCapabilities=CAP_NET_BIND_SERVICE
   ExecStart=/usr/local/bin/ss-server -c /etc/shadowsocks-libev/config.json
   
   [Install]
   WantedBy=multi-user.target
   ''' > /etc/systemd/system/ss.service
   systemctl daemon-reload
   ```

   

5. 配置 ss 快速启动/关闭 shell 脚本

   ```
   cd /etc/
   mkdir -p shs
   cd shs
   
   echo '''#!/bin/sh
   systemctl start ss
   ''' > /etc/shs/ssstart.sh
   
   echo '''#!/bin/sh
   systemctl stop ss
   ''' > /etc/shs/ssstop.sh
   
   ```

6. 开机启动 ss服务

   ```
   # 开机自动启动ss服务
   sudo systemctl enable ss
   ```

   

7. 配置 服务器 自动重启
   ```
   cd /etc/
   mkdir -p shs
   cd shs
   echo '''sudo reboot''' > /etc/shs/autoReboot.sh
   sudo chmod u+x /etc/shs/autoReboot.sh
   sudo crontab -e 
   # 手动贴入：0	*/6	*	*	*	sh /etc/shs/autoReboot.sh
   ```

   


